graph TD
    subgraph "User Interaction"
        A[User runs 'aichemist <command>'] --> B{Entry Point};
    end

    subgraph "Entry Point"
        B --> C[main.py / cli.py];
        C --> D[interfaces.cli.cli.cli_app];
    end

    subgraph "CLI Initialization interfaces/cli/cli.py"
        D --> E[Typer App Initialization cli_app];
        E --> F[Instantiate CLI Class];
        F --> G[Initialize Infrastructure Services DirectoryManager, FileReader];
        G --> H[Register Command Groups analysis, config, fs, etc.];
    end

    subgraph "Command Execution"
        H --> I{Typer Routes to Command};
        I --> J[Command Function e.g., interfaces/cli/commands/analysis.py];
    end

    subgraph "Service Interaction Clean Architecture Layers"
        J --> K(Application Layer - Service Interface);
        K --> L[Infrastructure Layer - Service Implementation CodeAnalysisService];
        L --> M["Infrastructure Components (e.g., CodeArtifactRepository, ast)"];
        M --> N(Domain Layer - Entities/Interfaces e.g., CodeArtifact);
        L --> O[Output via Rich Console];
    end

    style K fill:#f9f,stroke:#333,stroke-width:2px,color:#000;
    style L fill:#ccf,stroke:#333,stroke-width:2px,color:#000;
    style M fill:#ccf,stroke:#333,stroke-width:2px,color:#000;
    style N fill:#ff9,stroke:#333,stroke-width:2px,color:#000;

    linkStyle 9 stroke:#f9f,stroke-width:2px;
    linkStyle 10 stroke:#ccf,stroke-width:2px;
    linkStyle 11 stroke:#ccf,stroke-width:2px;
    linkStyle 12 stroke:#ff9,stroke-width:2px;
